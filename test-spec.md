# テスト仕様書: Flask + OpenRouter AI チャットアプリ

## 1. テスト対象
- `app.py`（Flaskサーバー/APIバックエンド）
- `static/index.html`（フロントエンドUI）
- `static/add.html`（フロントエンドUI）
- `static/search.html`（フロントエンドUI）
- `static/AIrecipe.html`（フロントエンドUI）


## 2. テスト環境
- Windows 10/11
- Python 3.8以降
- Flask, openai, python-dotenv
- OpenRouter APIキー設定済み
- ブラウザ: Chrome, Edge, Firefox

## 3. テスト項目

### 3.1. サーバー起動・静的ファイル配信
| No | テスト内容 | 手順 | 期待結果 |
|----|------------|------|----------|
| 1  | サーバー起動 | `python app.py`で起動 | エラーなく起動し、`http://localhost:5000/`でアクセス可能 |
| 2  | index.html配信 | ブラウザで`/`にアクセス | Vue.js UIが表示される |

### 3.2. /send_api API 正常系
| No | テスト内容 | 手順 | 期待結果 |
|----|------------|------|----------|
| 3  | レシピ追加 | レシピ追加ボタンを押し、料理名、材料、作り方を入力 | "レシピを保存しました"が返る |
| 4  | AIレシピ検索 | AIレシピボタンを押し、料理名を入力 | 指定した料理名のレシピをAIが生成して返る |
| 5  | レシピ検索 | レシピ検索ボタンを押し、料理名を入力 | 指定した料理名のレシピが返る |
| 6  | レシピ削除 | 登録したレシピ右上の削除ボタンを押す | 確認の |
### 3.2. API 正常系
| No | テスト内容 | 手順 | 期待結果 |
|----|------------|-----------------|------|----------|
| 3  | レシピ一覧取得 | トップページにアクセス | 登録済みのレシピ一覧がJSON形式で返却され、画面に表示される |
| 4  | レシピ追加 | レシピ追加画面で各項目を入力し、「レシピを追加」ボタンを押す | HTTP 201 と "レシピを保存しました！"が返る。トップページに遷移し、追加したレシピが表示される |
| 5  | レシピ検索 | レシピ検索画面でキーワードを入力し、「検索」ボタンを押す | キーワードに一致するレシピ一覧がJSON形式で返却され、画面に表示される |
| 6  | レシピ削除 | レシピ一覧または検索結果で、レシピ右上の「×」ボタンを押す | 確認ダイアログで「OK」を押すと、HTTP 200 と "レシピを削除しました。"が返る。画面から該当レシピが消える |
| 7  | AIレシピ生成 | AIレシピ画面で料理名などを入力し、「レシピを検索」ボタンを押す | AIが生成したレシピがJSON形式で返却され、画面に表示される |

### 3.3. API 異常系
| No | テスト内容 | 手順 | 期待結果 |
|----|------------|-----------------|------|----------|
| 8  | レシピ追加（不正なデータ） | `recipe_name` を含まないJSONをAPIに直接送信 | HTTP 400 と "Invalid data"が返る |
| 9  | AIレシピ生成（材料未入力） | AIレシピ画面で何も入力せずに「レシピを検索」ボタンを押す | ブラウザのバリデーションで送信がブロックされる。APIに直接空のingredientsを送信した場合、HTTP 400 と "材料が入力されていません。"が返る |
| 10 | レシピ削除（存在しないID） | 存在しない `recipe_id` を指定してAPIを直接呼び出す | HTTP 404 と "指定されたIDのレシピが見つかりませんでした。"が返る |
| 11 | AIレシピ生成（APIキー未設定） | .envの `OPENROUTER_API_KEY` を未設定でサーバーを起動し、AIレシピ生成を実行 | HTTP 500 と "OpenRouter API key is not configured on the server."が返る |
| 12 | AIレシピ生成（レートリミット超過） | OpenRouter APIのレートリミットを超えるリクエストを短時間に送信 | HTTP 429 と "リクエストが多すぎます。少し時間をおいてから再度お試しください。"が返る |
| 13 | AIレシピ生成（通信エラー） | OpenRouter APIとの通信を意図的に失敗させる（例: ネットワーク切断） | HTTP 500 と "AIとの通信中にエラーが発生しました。"が返る |
| 14 | AIレシピ生成（不正なJSON応答）| AIがJSON形式ではない応答を返した場合（プロンプト変更などで再現） | HTTP 500 と "AIとの通信中にエラーが発生しました。"が返る |

### 3.4. UIテスト
| No | テスト内容 | 手順 | 期待結果 |
|----|------------|------|----------|
| 15 | 空の入力フィールド | レシピ追加画面、AIレシピ画面、検索画面で必須項目を空のまま送信しようとする | HTML5のrequired属性により、ブラウザが「このフィールドを入力してください」といったメッセージを表示し、送信をブロックする |

## 4. その他
- 入力最大長、応答最大長の確認
- 日本語以外の入力対応
- レスポンス速度の目安計測

---
